<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!--suppress ALL -->
<mapper namespace="com.huiyi.campus.dao.mapper.web.phy.PhyStudentInfoMapper">
    <resultMap id="BaseResultMap" type="com.huiyi.campus.dao.entity.phy.PhyStudentInfoEntity">
        <id column="id" jdbcType="VARCHAR" property="id"/>
        <result column="student_name" jdbcType="VARCHAR" property="studentName"/>
        <result column="sex" jdbcType="TINYINT" property="sex"/>
        <result column="age" jdbcType="INTEGER" property="age"/>
        <result column="birth_date" jdbcType="VARCHAR" property="birthDate"/>
        <result column="parent_id" jdbcType="VARCHAR" property="parentId"/>
        <result column="school_id" jdbcType="INTEGER" property="schoolId"/>
        <result column="organ_id" jdbcType="INTEGER" property="organId"/>
        <result column="student_number" jdbcType="VARCHAR" property="studentNumber"/>
        <result column="major_class" jdbcType="VARCHAR" property="majorClass"/>
        <result column="class_id" jdbcType="VARCHAR" property="classId"/>
        <result column="nationality" jdbcType="TINYINT" property="nationality"/>
        <result column="id_card" jdbcType="VARCHAR" property="idCard"/>
        <result column="phone_number" jdbcType="VARCHAR" property="phoneNumber"/>
        <result column="image" jdbcType="VARCHAR" property="image"/>
        <result column="family_address" jdbcType="VARCHAR" property="familyAddress"/>
        <result column="census_address" jdbcType="VARCHAR" property="censusAddress"/>
        <result column="enter_time" jdbcType="TIMESTAMP" property="enterTime"/>
        <result column="doctor_id" jdbcType="INTEGER" property="doctorId"/>
        <result column="duty_doctor" jdbcType="VARCHAR" property="dutyDoctor"/>
        <result column="phy_file_date" jdbcType="TIMESTAMP" property="phyFileDate"/>
        <result column="create_time" jdbcType="TIMESTAMP" property="createTime"/>
        <result column="update_time" jdbcType="TIMESTAMP" property="updateTime"/>
        <result column="operator_id" jdbcType="INTEGER" property="operatorId"/>
        <result column="del_flag" jdbcType="TINYINT" property="delFlag"/>
        <result column="extend1" jdbcType="VARCHAR" property="extend1"/>
        <result column="extend2" jdbcType="VARCHAR" property="extend2"/>
        <result column="extend3" jdbcType="VARCHAR" property="extend3"/>
        <result column="extend4" jdbcType="VARCHAR" property="extend4"/>
        <result column="extend5" jdbcType="VARCHAR" property="extend5"/>
    </resultMap>
    <sql id="Base_Column_List">
        id
                , student_name, sex, age, birth_date, parent_id, school_id, organ_id, student_number,
    major_class, class_id, nationality, id_card, phone_number, image, family_address,
    census_address, enter_time, doctor_id, duty_doctor, phy_file_date, create_time, update_time,
    operator_id, del_flag, extend1, extend2, extend3, extend4, extend5
    </sql>
    <select id="selectByPrimaryKey" parameterType="java.lang.String" resultMap="BaseResultMap">
        select
        <include refid="Base_Column_List"/>
        from phy_student_info
        where id = #{id,jdbcType=VARCHAR}
    </select>
    <delete id="deleteByPrimaryKey" parameterType="java.lang.String">
        delete
        from phy_student_info
        where id = #{id,jdbcType=VARCHAR}
    </delete>
    <insert id="insert" parameterType="com.huiyi.campus.dao.entity.phy.PhyStudentInfoEntity">
        insert into phy_student_info (id, student_name, sex,
                                      age, birth_date, parent_id,
                                      school_id, organ_id, student_number,
                                      major_class, class_id, nationality,
                                      id_card, phone_number, image,
                                      family_address, census_address, enter_time,
                                      doctor_id, duty_doctor, phy_file_date,
                                      create_time, update_time, operator_id,
                                      del_flag, extend1, extend2,
                                      extend3, extend4, extend5)
        values (#{id,jdbcType=VARCHAR}, #{studentName,jdbcType=VARCHAR}, #{sex,jdbcType=TINYINT},
                #{age,jdbcType=INTEGER}, #{birthDate,jdbcType=VARCHAR}, #{parentId,jdbcType=VARCHAR},
                #{schoolId,jdbcType=INTEGER}, #{organId,jdbcType=INTEGER}, #{studentNumber,jdbcType=VARCHAR},
                #{majorClass,jdbcType=VARCHAR}, #{classId,jdbcType=VARCHAR}, #{nationality,jdbcType=TINYINT},
                #{idCard,jdbcType=VARCHAR}, #{phoneNumber,jdbcType=VARCHAR}, #{image,jdbcType=VARCHAR},
                #{familyAddress,jdbcType=VARCHAR}, #{censusAddress,jdbcType=VARCHAR}, #{enterTime,jdbcType=TIMESTAMP},
                #{doctorId,jdbcType=INTEGER}, #{dutyDoctor,jdbcType=VARCHAR}, #{phyFileDate,jdbcType=TIMESTAMP},
                #{createTime,jdbcType=TIMESTAMP}, #{updateTime,jdbcType=TIMESTAMP}, #{operatorId,jdbcType=INTEGER},
                #{delFlag,jdbcType=TINYINT}, #{extend1,jdbcType=VARCHAR}, #{extend2,jdbcType=VARCHAR},
                #{extend3,jdbcType=VARCHAR}, #{extend4,jdbcType=VARCHAR}, #{extend5,jdbcType=VARCHAR})
    </insert>
    <insert id="insertSelective" parameterType="com.huiyi.campus.dao.entity.phy.PhyStudentInfoEntity">
        insert into phy_student_info
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="id != null">
                id,
            </if>
            <if test="studentName != null">
                student_name,
            </if>
            <if test="sex != null">
                sex,
            </if>
            <if test="age != null">
                age,
            </if>
            <if test="birthDate != null">
                birth_date,
            </if>
            <if test="parentId != null">
                parent_id,
            </if>
            <if test="schoolId != null">
                school_id,
            </if>
            <if test="organId != null">
                organ_id,
            </if>
            <if test="studentNumber != null">
                student_number,
            </if>
            <if test="majorClass != null">
                major_class,
            </if>
            <if test="classId != null">
                class_id,
            </if>
            <if test="nationality != null">
                nationality,
            </if>
            <if test="idCard != null">
                id_card,
            </if>
            <if test="phoneNumber != null">
                phone_number,
            </if>
            <if test="image != null">
                image,
            </if>
            <if test="familyAddress != null">
                family_address,
            </if>
            <if test="censusAddress != null">
                census_address,
            </if>
            <if test="enterTime != null">
                enter_time,
            </if>
            <if test="doctorId != null">
                doctor_id,
            </if>
            <if test="dutyDoctor != null">
                duty_doctor,
            </if>
            <if test="phyFileDate != null">
                phy_file_date,
            </if>
            <if test="createTime != null">
                create_time,
            </if>
            <if test="updateTime != null">
                update_time,
            </if>
            <if test="operatorId != null">
                operator_id,
            </if>
            <if test="delFlag != null">
                del_flag,
            </if>
            <if test="extend1 != null">
                extend1,
            </if>
            <if test="extend2 != null">
                extend2,
            </if>
            <if test="extend3 != null">
                extend3,
            </if>
            <if test="extend4 != null">
                extend4,
            </if>
            <if test="extend5 != null">
                extend5,
            </if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="id != null">
                #{id,jdbcType=VARCHAR},
            </if>
            <if test="studentName != null">
                #{studentName,jdbcType=VARCHAR},
            </if>
            <if test="sex != null">
                #{sex,jdbcType=TINYINT},
            </if>
            <if test="age != null">
                #{age,jdbcType=INTEGER},
            </if>
            <if test="birthDate != null">
                #{birthDate,jdbcType=VARCHAR},
            </if>
            <if test="parentId != null">
                #{parentId,jdbcType=VARCHAR},
            </if>
            <if test="schoolId != null">
                #{schoolId,jdbcType=INTEGER},
            </if>
            <if test="organId != null">
                #{organId,jdbcType=INTEGER},
            </if>
            <if test="studentNumber != null">
                #{studentNumber,jdbcType=VARCHAR},
            </if>
            <if test="majorClass != null">
                #{majorClass,jdbcType=VARCHAR},
            </if>
            <if test="classId != null">
                #{classId,jdbcType=VARCHAR},
            </if>
            <if test="nationality != null">
                #{nationality,jdbcType=TINYINT},
            </if>
            <if test="idCard != null">
                #{idCard,jdbcType=VARCHAR},
            </if>
            <if test="phoneNumber != null">
                #{phoneNumber,jdbcType=VARCHAR},
            </if>
            <if test="image != null">
                #{image,jdbcType=VARCHAR},
            </if>
            <if test="familyAddress != null">
                #{familyAddress,jdbcType=VARCHAR},
            </if>
            <if test="censusAddress != null">
                #{censusAddress,jdbcType=VARCHAR},
            </if>
            <if test="enterTime != null">
                #{enterTime,jdbcType=TIMESTAMP},
            </if>
            <if test="doctorId != null">
                #{doctorId,jdbcType=INTEGER},
            </if>
            <if test="dutyDoctor != null">
                #{dutyDoctor,jdbcType=VARCHAR},
            </if>
            <if test="phyFileDate != null">
                #{phyFileDate,jdbcType=TIMESTAMP},
            </if>
            <if test="createTime != null">
                #{createTime,jdbcType=TIMESTAMP},
            </if>
            <if test="updateTime != null">
                #{updateTime,jdbcType=TIMESTAMP},
            </if>
            <if test="operatorId != null">
                #{operatorId,jdbcType=INTEGER},
            </if>
            <if test="delFlag != null">
                #{delFlag,jdbcType=TINYINT},
            </if>
            <if test="extend1 != null">
                #{extend1,jdbcType=VARCHAR},
            </if>
            <if test="extend2 != null">
                #{extend2,jdbcType=VARCHAR},
            </if>
            <if test="extend3 != null">
                #{extend3,jdbcType=VARCHAR},
            </if>
            <if test="extend4 != null">
                #{extend4,jdbcType=VARCHAR},
            </if>
            <if test="extend5 != null">
                #{extend5,jdbcType=VARCHAR},
            </if>
        </trim>
    </insert>
    <update id="updateByPrimaryKeySelective" parameterType="com.huiyi.campus.dao.entity.phy.PhyStudentInfoEntity">
        update phy_student_info
        <set>
            <if test="studentName != null">
                student_name = #{studentName,jdbcType=VARCHAR},
            </if>
            <if test="sex != null">
                sex = #{sex,jdbcType=TINYINT},
            </if>
            <if test="age != null">
                age = #{age,jdbcType=INTEGER},
            </if>
            <if test="birthDate != null">
                birth_date = #{birthDate,jdbcType=VARCHAR},
            </if>
            <if test="parentId != null">
                parent_id = #{parentId,jdbcType=VARCHAR},
            </if>
            <if test="schoolId != null">
                school_id = #{schoolId,jdbcType=INTEGER},
            </if>
            <if test="organId != null">
                organ_id = #{organId,jdbcType=INTEGER},
            </if>
            <if test="studentNumber != null">
                student_number = #{studentNumber,jdbcType=VARCHAR},
            </if>
            <if test="majorClass != null">
                major_class = #{majorClass,jdbcType=VARCHAR},
            </if>
            <if test="classId != null">
                class_id = #{classId,jdbcType=VARCHAR},
            </if>
            <if test="nationality != null">
                nationality = #{nationality,jdbcType=TINYINT},
            </if>
            <if test="idCard != null">
                id_card = #{idCard,jdbcType=VARCHAR},
            </if>
            <if test="phoneNumber != null">
                phone_number = #{phoneNumber,jdbcType=VARCHAR},
            </if>
            <if test="image != null">
                image = #{image,jdbcType=VARCHAR},
            </if>
            <if test="familyAddress != null">
                family_address = #{familyAddress,jdbcType=VARCHAR},
            </if>
            <if test="censusAddress != null">
                census_address = #{censusAddress,jdbcType=VARCHAR},
            </if>
            <if test="enterTime != null">
                enter_time = #{enterTime,jdbcType=TIMESTAMP},
            </if>
            <if test="doctorId != null">
                doctor_id = #{doctorId,jdbcType=INTEGER},
            </if>
            <if test="dutyDoctor != null">
                duty_doctor = #{dutyDoctor,jdbcType=VARCHAR},
            </if>
            <if test="phyFileDate != null">
                phy_file_date = #{phyFileDate,jdbcType=TIMESTAMP},
            </if>
            <if test="createTime != null">
                create_time = #{createTime,jdbcType=TIMESTAMP},
            </if>
            <if test="updateTime != null">
                update_time = #{updateTime,jdbcType=TIMESTAMP},
            </if>
            <if test="operatorId != null">
                operator_id = #{operatorId,jdbcType=INTEGER},
            </if>
            <if test="delFlag != null">
                del_flag = #{delFlag,jdbcType=TINYINT},
            </if>
            <if test="extend1 != null">
                extend1 = #{extend1,jdbcType=VARCHAR},
            </if>
            <if test="extend2 != null">
                extend2 = #{extend2,jdbcType=VARCHAR},
            </if>
            <if test="extend3 != null">
                extend3 = #{extend3,jdbcType=VARCHAR},
            </if>
            <if test="extend4 != null">
                extend4 = #{extend4,jdbcType=VARCHAR},
            </if>
            <if test="extend5 != null">
                extend5 = #{extend5,jdbcType=VARCHAR},
            </if>
        </set>
        where id = #{id,jdbcType=VARCHAR}
    </update>
    <update id="updateByPrimaryKey" parameterType="com.huiyi.campus.dao.entity.phy.PhyStudentInfoEntity">
        update phy_student_info
        set student_name   = #{studentName,jdbcType=VARCHAR},
            sex            = #{sex,jdbcType=TINYINT},
            age            = #{age,jdbcType=INTEGER},
            birth_date     = #{birthDate,jdbcType=VARCHAR},
            parent_id      = #{parentId,jdbcType=VARCHAR},
            school_id      = #{schoolId,jdbcType=INTEGER},
            organ_id       = #{organId,jdbcType=INTEGER},
            student_number = #{studentNumber,jdbcType=VARCHAR},
            major_class    = #{majorClass,jdbcType=VARCHAR},
            class_id       = #{classId,jdbcType=VARCHAR},
            nationality    = #{nationality,jdbcType=TINYINT},
            id_card        = #{idCard,jdbcType=VARCHAR},
            phone_number   = #{phoneNumber,jdbcType=VARCHAR},
            image          = #{image,jdbcType=VARCHAR},
            family_address = #{familyAddress,jdbcType=VARCHAR},
            census_address = #{censusAddress,jdbcType=VARCHAR},
            enter_time     = #{enterTime,jdbcType=TIMESTAMP},
            doctor_id      = #{doctorId,jdbcType=INTEGER},
            duty_doctor    = #{dutyDoctor,jdbcType=VARCHAR},
            phy_file_date       = #{phyFileDate,jdbcType=TIMESTAMP},
            create_time    = #{createTime,jdbcType=TIMESTAMP},
            update_time    = #{updateTime,jdbcType=TIMESTAMP},
            operator_id    = #{operatorId,jdbcType=INTEGER},
            del_flag       = #{delFlag,jdbcType=TINYINT},
            extend1        = #{extend1,jdbcType=VARCHAR},
            extend2        = #{extend2,jdbcType=VARCHAR},
            extend3        = #{extend3,jdbcType=VARCHAR},
            extend4        = #{extend4,jdbcType=VARCHAR},
            extend5        = #{extend5,jdbcType=VARCHAR}
        where id = #{id,jdbcType=VARCHAR}
    </update>
    <!--查询所有学生档案信息-->
    <select id="selectAll" resultType="com.huiyi.campus.dao.vo.health.StudentInfoRecordVo">
        SELECT
        info.id as "id",
        info.student_name as "studentName",
        info.sex as "sex",
        info.age as "age",
        info.birth_date as "birthDate",
        p.user_name as "parentName",
        school.school_name as "schoolName",
        organ.organ_name as "organName",
        info.student_number as "studentNumber",
        info.major_class as "majorClass",
        info.class_id as "classId",
        info.nationality as "nationality",
        info.id_card as "idCard",
        info.phone_number as "phoneNumber",
        info.image as "image",
        info.family_address as "familyAddress",
        info.census_address as "censusAddress",
        info.enter_time as "enterTime",
        doctor.doctor_name as "doctorName",
        info.duty_doctor as "dutyDoctor",
        info.phy_file_date as "phyFileDate",
        info.create_time as "createTime",
        info.operator_id as "operatorId"
        FROM
        phy_student_info info
        LEFT JOIN sys_parent p on info.parent_id = p.id
        LEFT JOIN sys_school school on info.school_id = school.id
        LEFT JOIN sys_organ organ on info.organ_id = organ.id
        LEFT JOIN sys_grade_class class on info.class_id = class.id
        LEFT JOIN sys_doctor doctor on info.doctor_id = doctor.id
        WHERE 1=1
        <if test="id != null and id!=''">
            AND info.id = #{id,jdbcType=VARCHAR}
        </if>
        <if test="studentName != null and studentName!=''">
            AND info.student_name = #{studentName,jdbcType=VARCHAR}
        </if>
        <if test="sex != null and sex!=''">
            AND info.sex = #{sex,jdbcType=TINYINT}
        </if>
        <if test="familyAddress != null and familyAddress!=''">
            AND info.family_address = #{familyAddress,jdbcType=VARCHAR}
        </if>
        <if test="censusAddress != null and censusAddress!=''">
            AND info.census_address = #{censusAddress,jdbcType=VARCHAR}
        </if>
        <if test="studentNumber != null and studentNumber!=''">
            AND info.student_number = #{studentNumber,jdbcType=VARCHAR}
        </if>
        <if test="schoolId != null and schoolId!=''">
            AND info.school_id = #{schoolId,jdbcType=INTEGER}
        </if>
        <if test="classId != null and classId!=''">
            AND info.class_id = #{classId,jdbcType=INTEGER}
        </if>
    </select>

    <!--批量导入学生档案信息-->
    <insert id="insertSelectiveList" parameterType="java.util.List">
        <foreach collection="list" item="item" index="index"
                 separator=";">
            insert into phy_student_info
            <trim prefix="(" suffix=")" suffixOverrides=",">
                <if test="item.id != null">
                    id,
                </if>
                <if test="item.studentName != null">
                    student_name,
                </if>
                <if test="item.sex != null">
                    sex,
                </if>
                <if test="item.age != null">
                    age,
                </if>
                <if test="item.birthDate != null">
                    birth_date,
                </if>
                <if test="item.parentId != null">
                    parent_id,
                </if>
                <if test="item.schoolId != null">
                    school_id,
                </if>
                <if test="item.studentNumber != null">
                    student_number,
                </if>
                <if test="item.majorClass != null">
                    major_class,
                </if>
                <if test="item.classId != null">
                    class_id,
                </if>
                <if test="item.idCard != null">
                    id_card,
                </if>
                <if test="item.phoneNumber != null">
                    phone_number,
                </if>
                <if test="item.image != null">
                    image,
                </if>
                <if test="item.familyAddress != null">
                    family_address,
                </if>
                <if test="item.censusAddress != null">
                    census_address,
                </if>
                <if test="item.enterTime != null">
                    enter_time,
                </if>
                <if test="item.doctorId != null">
                    doctor_id,
                </if>
                <if test="item.dutyDoctor != null">
                    duty_doctor,
                </if>
                <if test="item.phyFileDate != null">
                    phy_file_date,
                </if>
                <if test="item.createTime != null">
                    create_time,
                </if>
                <if test="item.updateTime != null">
                    update_time,
                </if>
                <if test="item.operatorId != null">
                    operator_id,
                </if>
                <if test="item.extend1 != null">
                    extend1,
                </if>
                <if test="item.extend2 != null">
                    extend2,
                </if>
                <if test="item.extend3 != null">
                    extend3,
                </if>
                <if test="item.extend4 != null">
                    extend4,
                </if>
                <if test="item.extend5 != null">
                    extend5,
                </if>
            </trim>
            <trim prefix="values (" suffix=")" suffixOverrides=",">
                <if test="item.id != null">
                    #{item.id,jdbcType=VARCHAR},
                </if>
                <if test="item.studentName != null">
                    #{item.studentName,jdbcType=VARCHAR},
                </if>
                <if test="item.sex != null">
                    #{item.sex,jdbcType=TINYINT},
                </if>
                <if test="item.age != null">
                    #{item.age,jdbcType=INTEGER},
                </if>
                <if test="item.birthDate != null">
                    #{item.birthDate,jdbcType=VARCHAR},
                </if>
                <if test="item.parentId != null">
                    #{item.parentId,jdbcType=VARCHAR},
                </if>
                <if test="item.schoolId != null">
                    #{item.schoolId,jdbcType=INTEGER},
                </if>
                <if test="item.studentNumber != null">
                    #{item.studentNumber,jdbcType=VARCHAR},
                </if>
                <if test="item.majorClass != null">
                    #{item.majorClass,jdbcType=VARCHAR},
                </if>
                <if test="item.classId != null">
                    #{item.classId,jdbcType=VARCHAR},
                </if>
                <if test="item.idCard != null">
                    #{item.idCard,jdbcType=VARCHAR},
                </if>
                <if test="item.phoneNumber != null">
                    #{item.phoneNumber,jdbcType=VARCHAR},
                </if>
                <if test="item.image != null">
                    #{item.image,jdbcType=VARCHAR},
                </if>
                <if test="item.familyAddress != null">
                    #{item.familyAddress,jdbcType=VARCHAR},
                </if>
                <if test="item.censusAddress != null">
                    #{item.censusAddress,jdbcType=VARCHAR},
                </if>
                <if test="item.enterTime != null">
                    #{item.enterTime,jdbcType=TIMESTAMP},
                </if>
                <if test="item.doctorId != null">
                    #{item.doctorId,jdbcType=INTEGER},
                </if>
                <if test="item.dutyDoctor != null">
                    #{item.dutyDoctor,jdbcType=VARCHAR},
                </if>
                <if test="item.phyFileDate != null">
                    #{item.phyFileDate,jdbcType=TIMESTAMP},
                </if>
                <if test="item.createTime != null">
                    #{item.createTime,jdbcType=TIMESTAMP},
                </if>
                <if test="item.updateTime != null">
                    #{item.updateTime,jdbcType=TIMESTAMP},
                </if>
                <if test="item.operatorId != null">
                    #{item.operatorId,jdbcType=INTEGER},
                </if>
                <if test="item.extend1 != null">
                    #{item.extend1,jdbcType=VARCHAR},
                </if>
                <if test="item.extend2 != null">
                    #{item.extend2,jdbcType=VARCHAR},
                </if>
                <if test="item.extend3 != null">
                    #{item.extend3,jdbcType=VARCHAR},
                </if>
                <if test="item.extend4 != null">
                    #{item.extend4,jdbcType=VARCHAR},
                </if>
                <if test="item.extend5 != null">
                    #{item.extend5,jdbcType=VARCHAR},
                </if>
            </trim>
        </foreach>
    </insert>
    <!--删除学生健康档案信息-->
    <delete id="deleteByPrimaryKeyAndHealthAndItem">
        DELETE phy_student_info,
                phy_student_health_info,
                phy_item_result
        FROM
	        phy_student_info
	    LEFT JOIN phy_student_health_info ON phy_student_info.id = phy_student_health_info.phy_student_id
	    LEFT JOIN phy_item_result ON phy_student_health_info.id = phy_item_result.phy_health_id
        WHERE
	        phy_student_info.id = #{id,jdbcType=VARCHAR}
    </delete>
</mapper>